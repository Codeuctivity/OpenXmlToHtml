using OpenXmlPowerTools;
using OpenXmlPowerTools.OpenXMLWordprocessingMLToHtmlConverter;
using System.Collections.Generic;
using System.Xml.Linq;

namespace Codeuctivity.OpenXmlToHtml
{
    /// <summary>
    /// Default handler that transforms every symbol into some html encoded font specific char
    /// </summary>
    public class SymbolHandler : IWordprocessingSymbolHandler
    {
        private static readonly Dictionary<string, string> symbolCharDictonary = new Dictionary<string, string>
    {
            {"F020"," "},
            {"F021","!"},
            {"F022","âˆ€"},
            {"F023","#"},
            {"F024","âˆƒ"},
            {"F025","%"},
            {"F026","&"},
            {"F027","âˆ‹"},
            {"F028","("},
            {"F029",")"},
            {"F02A","*"},
            {"F02B","+"},
            {"F02C",","},
            {"F02D","-"},
            {"F02E","."},
            {"F02F","/"},
            {"F030","0"},
            {"F031","1"},
            {"F032","2"},
            {"F033","3"},
            {"F034","4"},
            {"F035","5"},
            {"F036","6"},
            {"F037","7"},
            {"F038","8"},
            {"F039","9"},
            {"F03A",":"},
            {"F03B",";"},
            {"F03C","<"},
            {"F03D","="},
            {"F03E","?"},
            {"F03F","â‰…"},
            {"F040","A"},
            {"F041","B"},
            {"F042","X"},
            {"F043","Î”"},
            {"F044","E"},
            {"F045","Î¦"},
            {"F046","Î“"},
            {"F047","H"},
            {"F048","I"},
            {"F049","Ï‘"},
            {"F04A","K"},
            {"F04B","âˆ§"},
            {"F04C","M"},
            {"F04D","N"},
            {"F04E","O"},
            {"F04F","Î "},
            {"F050","Î˜"},
            {"F051","P"},
            {"F052","âˆ‘"},
            {"F053","T"},
            {"F054","Y"},
            {"F055","Î©"},
            {"F056","Îž"},
            {"F057","Î¨"},
            {"F058","Z"},
            {"F059","["},
            {"F05A","âˆ´"},
            {"F05B","]"},
            {"F05C","âŠ¥"},
            {"F05D","_"},
            {"F05E","Î±"},
            {"F05F","Î²"},
            {"F060","Ï‡"},
            {"F061","Î´"},
            {"F062","Îµ"},
            {"F063","Ï•"},
            {"F064","Î³"},
            {"F065","Î·"},
            {"F066","Î¹"},
            {"F067","Ï†"},
            {"F068","Îº"},
            {"F069","Î»"},
            {"F06A","Î¼"},
            {"F06B","Î½"},
            {"F06C","Î¿"},
            {"F06D","Ï€"},
            {"F06E","Î¸"},
            {"F06F","Ï"},
            {"F070","Ïƒ"},
            {"F071","Ï„"},
            {"F072","Ï…"},
            {"F073","Ï–"},
            {"F074","Ï‰"},
            {"F075","Î¾"},
            {"F076","Ïˆ"},
            {"F077","Î¶"},
            {"F078","{"},
            {"F079","|"},
            {"F07A","}"},
            {"F07B","~"},
            {"F07C","â–¡"},
            {"F07D","â“ª"},
            {"F07E","â‘ "},
            {"F07F","â‘¡"},
            {"F080","â‘¢"},
            {"F081","â‘£"},
            {"F082","â‘¤"},
            {"F083","â‘¥"},
            {"F084","â‘¦"},
            {"F085","â‘§"},
            {"F086","â‘¨"},
            {"F087","â‘©"},
            {"F088","â“¿"},
            {"F089","â¶"},
            {"F08A","â·"},
            {"F08B","â¸"},
            {"F08C","â¹"},
            {"F08D","âº"},
            {"F08E","â»"},
            {"F08F","â¼"},
            {"F090","â½"},
            {"F091","â¾"},
            {"F092","â¿"},
            {"F093","ðŸ™¢"},
            {"F094","ðŸ™ "},
            {"F095","ðŸ™¡"},
            {"F096","ðŸ™£"},
            {"F097","ðŸ™ž"},
            {"F098","ðŸ™œ"},
            {"F099","ðŸ™"},
            {"F09A","ðŸ™Ÿ"},
            {"F09B","Â·"},
            {"F09C","â€¢"},
            {"F0A0","â–ª"},
            {"F0A1","Ï’"},
            {"F0A2","â€²"},
            {"F0A3","â‰¤"},
            {"F0A4","/"},
            {"F0A5","âˆž"},
            //{"F0A6","Todo"},
            //{"F0A7","Todo"},
            //{"F0A8","Todo"},
            //{"F0A9","Todo"},
            //{"F0AA","Todo"},
            //{"F0AB","Todo"},
            //{"F0AC","Todo"},
            //{"F0AD","Todo"},
            //{"F0AE","Todo"},
            //{"F0AF","Todo"},
            //{"F0B0","Todo"},
            //{"F0B1","Todo"},
            //{"F0B2","Todo"},
            //{"F0B3","Todo"},
            //{"F0B4","Todo"},
            //{"F0B5","Todo"},
            //{"F0B6","Todo"},
            //{"F0B7","Todo"},
            //{"F0B8","Todo"},
            //{"F0B9","Todo"},
            //{"F0BA","Todo"},
            //{"F0BB","Todo"},
            //{"F0BC","Todo"},
            //{"F0BD","Todo"},
            //{"F0BE","Todo"},
            //{"F0BF","Todo"},
            //{"F0C0","Todo"},
            //{"F0C1","Todo"},
            //{"F0C2","Todo"},
            //{"F0C3","Todo"},
            //{"F0C4","Todo"},
            //{"F0C5","Todo"},
            //{"F0C6","Todo"},
            //{"F0C7","Todo"},
            //{"F0C8","Todo"},
            //{"F0C9","Todo"},
            //{"F0CA","Todo"},
            //{"F0CB","Todo"},
            //{"F0CC","Todo"},
            //{"F0CD","Todo"},
            //{"F0CE","Todo"},
            //{"F0CF","Todo"},
            //{"F0D0","Todo"},
            //{"F0D1","Todo"},
            //{"F0D2","Todo"},
            //{"F0D3","Todo"},
            //{"F0D4","Todo"},
            //{"F0D5","Todo"},
            //{"F0D6","Todo"},
            //{"F0D7","Todo"},
            //{"F0D8","Todo"},
            //{"F0D9","Todo"},
            //{"F0DA","Todo"},
            //{"F0DB","Todo"},
            //{"F0DC","Todo"},
            //{"F0DD","Todo"},
            //{"F0DE","Todo"},
            //{"F0DF","Todo"},
            //{"F0E0","Todo"},
            //{"F0E1","Todo"},
            //{"F0E2","Todo"},
            //{"F0E3","Todo"},
            //{"F0E4","Todo"},
            //{"F0E5","Todo"},
            //{"F0E6","Todo"},
            //{"F0E7","Todo"},
            //{"F0E8","Todo"},
            //{"F0E9","Todo"},
            //{"F0EA","Todo"},
            //{"F0EB","Todo"},
            //{"F0EC","Todo"},
            //{"F0ED","Todo"},
            //{"F0EE","Todo"},
            //{"F0EF","Todo"},
            //{"F0F0","Todo"},
            //{"F0F1","Todo"},
            //{"F0F2","Todo"},
            //{"F0F3","Todo"},
            //{"F0F4","Todo"},
            //{"F0F5","Todo"},
            //{"F0F6","Todo"},
            //{"F0F7","Todo"},
            //{"F0F8","Todo"},
            //{"F0F9","Todo"},
            //{"F0FA","Todo"},
            //{"F0FB","Todo"},
            //{"F0FC","Todo"},
            //{"F0FD","Todo"},
            //{"F0FE","Todo"},
            //{"F0FF","Todo"}
    };

        private DefaultSymbolHandler DefaultSymbolHandler { get; set; }

        /// <summary>
        /// Default ctor
        /// </summary>
        public SymbolHandler()
        {
            DefaultSymbolHandler = new DefaultSymbolHandler();
        }

        /// <summary>
        /// Default handler that transforms every symbol into some html encoded font specific char
        /// </summary>
        /// <param name="element"></param>
        /// <param name="fontFamily"></param>
        /// <returns></returns>
        public XElement TransformSymbol(XElement element, Dictionary<string, string> fontFamily)
        {
            if (fontFamily.TryGetValue("font-family", out var currentFontFamily) && currentFontFamily == "Symbol")
            {
                var customChar = element.Attribute(W._char).Value;

                if (symbolCharDictonary.TryGetValue(customChar, out var commonChar))
                {
                    return new XElement(Xhtml.span, commonChar);
                }
            }

            return DefaultSymbolHandler.TransformSymbol(element, fontFamily);
        }
    }
}