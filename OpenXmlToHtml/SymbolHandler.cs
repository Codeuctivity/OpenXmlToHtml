using OpenXmlPowerTools;
using OpenXmlPowerTools.OpenXMLWordprocessingMLToHtmlConverter;
using System.Collections.Generic;
using System.Xml.Linq;

namespace Codeuctivity.OpenXmlToHtml
{
    /// <summary>
    /// Handler that transforms every symbol into some HTML encoded font specific char
    /// </summary>
    public class SymbolHandler : ISymbolHandler
    {
        private OpenXmlPowerTools.OpenXMLWordprocessingMLToHtmlConverter.SymbolHandler DefaultSymbolHandler { get; set; }

        /// <summary>
        /// Dictionary codes from symbol char to Unicode
        /// </summary>
        public static Dictionary<string, string> SymbolCharDictonary => new Dictionary<string, string>
    {
            {"F020"," "},
            {"F021","!"},
            {"F022","âˆ€"},
            {"F023","#"},
            {"F024","âˆƒ"},
            {"F025","%"},
            {"F026","&"},
            {"F027","âˆ‹"},
            {"F028","("},
            {"F029",")"},
            {"F02A","*"},
            {"F02B","+"},
            {"F02C",","},
            {"F02D","-"},
            {"F02E","."},
            {"F02F","/"},
            {"F030","0"},
            {"F031","1"},
            {"F032","2"},
            {"F033","3"},
            {"F034","4"},
            {"F035","5"},
            {"F036","6"},
            {"F037","7"},
            {"F038","8"},
            {"F039","9"},
            {"F03A",":"},
            {"F03B",";"},
            {"F03C","<"},
            {"F03D","="},
            {"F03E",">"},
            {"F03F","?"},
            {"F040","â‰…"},
            {"F041","A"},
            {"F042","B"},
            {"F043","X"},
            {"F044","Î”"},
            {"F045","E"},
            {"F046","Î¦"},
            {"F047","Î“"},
            {"F048","H"},
            {"F049","I"},
            {"F04A","Ï‘"},
            {"F04B","K"},
            {"F04C","âˆ§"},
            {"F04D","M"},
            {"F04E","N"},
            {"F04F","O"},
            {"F050","Î "},
            {"F051","Î˜"},
            {"F052","P"},
            {"F053","âˆ‘"},
            {"F054","T"},
            {"F055","Y"},
            {"F056","Z"},
            {"F057","Î©"},
            {"F058","Î"},
            {"F059","Î¨"},
            {"F05A","Z"},
            {"F05B","["},
            {"F05C","âˆ´"},
            {"F05D","]"},
            {"F05E","âŠ¥"},
            {"F05F","_"},
            // Not sure, but I think that overline has a context specific effect on the following char
            {"F060","\u0305"},
            {"F061","Î±"},
            {"F062","Î²"},
            {"F063","Ï‡"},
            {"F064","Î´"},
            {"F065","Îµ"},
            {"F066","Ï•"},
            {"F067","Î³"},
            {"F068","Î·"},
            {"F069","Î¹"},
            {"F06A","Ï†"},
            {"F06B","Îº"},
            {"F06C","Î»"},
            {"F06D","Î¼"},
            {"F06E","Î½"},
            {"F06F","Î¿"},
            {"F070","Ï€"},
            {"F071","Î¸"},
            {"F072","Ï"},
            {"F073","Ïƒ"},
            {"F074","Ï„"},
            {"F075","Ï…"},
            {"F076","Ï–"},
            {"F077","Ï‰"},
            {"F078","Î¾"},
            {"F079","Ïˆ"},
            {"F07A","Î¶"},
            {"F07B","{"},
            {"F07C","|"},
            {"F07D","}"},
            {"F07E","âˆ¼"},
            {"F07F","â–¡"},
            {"F080","â–¡"},
            {"F081","â–¡"},
            {"F082","â–¡"},
            {"F083","â–¡"},
            {"F084","â–¡"},
            {"F085","â–¡"},
            {"F086","â–¡"},
            {"F087","â–¡"},
            {"F088","â–¡"},
            {"F089","â–¡"},
            {"F08A","â–¡"},
            {"F08B","â–¡"},
            {"F08C","â–¡"},
            {"F08D","â–¡"},
            {"F08E","â–¡"},
            {"F08F","â–¡"},
            {"F090","â–¡"},
            {"F091","â–¡"},
            {"F092","â–¡"},
            {"F093","â–¡"},
            {"F094","â–¡"},
            {"F095","â–¡"},
            {"F096","â–¡"},
            {"F097","â–¡"},
            {"F098","â–¡"},
            {"F099","â–¡"},
            {"F09A","â–¡"},
            {"F09B","â–¡"},
            {"F09C","â–¡"},
            {"F09D","â–¡"},
            {"F09E","â–¡"},
            {"F09F","â–¡"},
            {"F0A0","â–¡"},
            {"F0A1","Ï’"},
            {"F0A2","â€²"},
            {"F0A3","â‰¤"},
            {"F0A4","âˆ"},
            {"F0A5","â„"},
            {"F0A6","Æ’"},
            {"F0A7","â™£"},
            {"F0A8","â™¦"},
            {"F0A9","â™¥"},
            {"F0AA","â™ "},
            {"F0AB","â†”"},
            {"F0AC","â†"},
            {"F0AD","â†‘"},
            {"F0AE","â†’"},
            {"F0AF","â†“"},
            {"F0B0","Â°"},
            {"F0B1","Â±"},
            {"F0B2","â€³"},
            {"F0B3","â‰¥"},
            {"F0B4","Ã—"},
            {"F0B5","âˆ"},
            {"F0B6","âˆ‚"},
            {"F0B7","â€¢"},
            {"F0B8","Ã·"},
            {"F0B9","â‰ "},
            {"F0BA","â‰¡"},
            {"F0BB","â‰ˆ"},
            {"F0BC","â€¦"},
            {"F0BD","â"},
            {"F0BE","â¯"},
            {"F0BF","â†µ"},
            {"F0C0","â„µ"},
            {"F0C1","â„‘"},
            {"F0C2","â„œ"},
            {"F0C3","â„˜"},
            {"F0C4","âŠ—"},
            {"F0C5","âŠ•"},
            {"F0C6","âˆ…"},
            {"F0C7","âˆ©"},
            {"F0C8","âˆª"},
            {"F0C9","âŠƒ"},
            {"F0CA","âŠ‡"},
            {"F0CB","âŠ„"},
            {"F0CC","âŠ‚"},
            {"F0CD","âŠ†"},
            {"F0CE","âˆˆ"},
            {"F0CF","âˆ‰"},
            {"F0D0","âˆ "},
            {"F0D1","âˆ‡"},
            {"F0D2","Â®ï¸"},
            {"F0D3","Â©ï¸"},
            {"F0D4","â„¢ï¸"},
            {"F0D5","âˆ"},
            {"F0D6","âˆš"},
            {"F0D7","â‹…"},
            {"F0D8","Â¬"},
            {"F0D9","âˆ§"},
            {"F0DA","âˆ¨"},
            {"F0DB","â‡”"},
            {"F0DC","â‡"},
            {"F0DD","â‡‘"},
            {"F0DE","â‡’"},
            {"F0DF","â‡“"},
            {"F0E0","â—Š"},
            {"F0E1","âŸ¨"},
            {"F0E2","Â®"},
            {"F0E3","Â©"},
            {"F0E4","â„¢"},
            {"F0E5","âˆ‘"},
            {"F0E6","â›"},
            {"F0E7","âœ"},
            {"F0E8","â"},
            {"F0E9","â¡"},
            {"F0EA","â¢"},
            {"F0EB","â£"},
            {"F0EC","â§"},
            {"F0ED","â¨"},
            {"F0EE","â©"},
            {"F0EF","âª"},
            {"F0F0","â–¡"},
            {"F0F1","âŒª"},
            {"F0F2","âˆ«"},
            {"F0F3","âŒ "},
            {"F0F4","â®"},
            {"F0F5","âŒ¡"},
            {"F0F6","â"},
            {"F0F7","âŸ"},
            {"F0F8","â "},
            {"F0F9","â¤"},
            {"F0FA","â¥"},
            {"F0FB","â¦"},
            {"F0FC","â«"},
            {"F0FD","â¬"},
            {"F0FE","â­"},
            {"F0FF","â–¡"}
    };

        /// <summary>
        /// Dictonary codes from wingdings char to unicode
        /// </summary>
        public static Dictionary<string, string> WingdingsCharDictonary => new Dictionary<string, string>
    {
            {"F020"," "},
            {"F021","ğŸ–‰"},
            {"F022","âœ‚"},
            {"F023","âœ"},
            {"F024","ğŸ‘“"},
            {"F025","ğŸ•­"},
            {"F026","ğŸ•®"},
            {"F027","ğŸ•¯"},
            {"F028","ğŸ•¿"},
            {"F029","âœ†"},
            {"F02A","ğŸ–‚"},
            {"F02B","ğŸ–ƒ"},
            {"F02C","ğŸ“ª"},
            {"F02D","ğŸ“«"},
            {"F02E","ğŸ“¬"},
            {"F02F","ğŸ“­"},
            {"F030","ğŸ—€"},
            {"F031","ğŸ—"},
            {"F032","ğŸ–¹"},
            {"F033","ğŸ—"},
            {"F034","ğŸ—"},
            {"F035","ğŸ—„"},
            {"F036","âŒ›"},
            {"F037","ğŸ–®"},
            {"F038","ğŸ–°"},
            {"F039","ğŸ–²"},
            {"F03A","ğŸ–³"},
            {"F03B","ğŸ–´"},
            {"F03C","ğŸ–«"},
            {"F03D","ğŸ–¬"},
            {"F03E","âœ‡"},
            {"F03F","âœ"},
            {"F040","ğŸ–"},
            {"F041","âœŒ"},
            {"F042","ğŸ‘Œ"},
            {"F043","ğŸ‘"},
            {"F044","ğŸ‘"},
            {"F045","â˜œ"},
            {"F046","â˜"},
            {"F047","â˜"},
            {"F048","â˜Ÿ"},
            {"F049","ğŸ–"},
            {"F04A","â˜º"},
            {"F04B","ğŸ˜"},
            {"F04C","â˜¹"},
            {"F04D","ğŸ’£"},
            {"F04E","â˜ "},
            {"F04F","ğŸ³"},
            {"F050","ğŸ±"},
            {"F051","âœˆ"},
            {"F052","â˜¼"},
            {"F053","ğŸ’§"},
            {"F054","â„"},
            {"F055","ğŸ•†"},
            {"F056","âœ"},
            {"F057","ğŸ•ˆ"},
            {"F058","âœ "},
            {"F059","âœ¡"},
            {"F05A","â˜ª"},
            {"F05B","â˜¯"},
            {"F05C","à¥"},
            {"F05D","â˜¸"},
            {"F05E","â™ˆ"},
            {"F05F","â™‰"},
            {"F060","â™Š"},
            {"F061","â™‹"},
            {"F062","â™Œ"},
            {"F063","â™"},
            {"F064","â™"},
            {"F065","â™"},
            {"F066","â™"},
            {"F067","â™‘"},
            {"F068","â™’"},
            {"F069","â™“"},
            {"F06A","ğŸ™°"},
            {"F06B","ğŸ™µ"},
            {"F06C","â—"},
            {"F06D","ğŸ”¾"},
            {"F06E","â– "},
            {"F06F","â–¡"},
            {"F070","ğŸ"},
            {"F071","â‘"},
            {"F072","â’"},
            {"F073","â¬§"},
            {"F074","â§«"},
            {"F075","â—†"},
            {"F076","â–"},
            {"F077","â¬¥"},
            {"F078","âŒ§"},
            {"F079","â®¹"},
            {"F07A","âŒ˜"},
            {"F07B","ğŸµ"},
            {"F07C","ğŸ¶"},
            {"F07D","ğŸ™¶"},
            {"F07E","ğŸ™·"},
            {"F07F","â–¡"},
            {"F080","â“ª"},
            {"F081","â‘ "},
            {"F082","â‘¡"},
            {"F083","â‘¢"},
            {"F084","â‘£"},
            {"F085","â‘¤"},
            {"F086","â‘¥"},
            {"F087","â‘¦"},
            {"F088","â‘§"},
            {"F089","â‘¨"},
            {"F08A","â‘©"},
            {"F08B","â“¿"},
            {"F08C","â¶"},
            {"F08D","â·"},
            {"F08E","â¸"},
            {"F08F","â¹"},
            {"F090","âº"},
            {"F091","â»"},
            {"F092","â¼"},
            {"F093","â½"},
            {"F094","â¾"},
            {"F095","â¿"},
            {"F096","ğŸ™¢"},
            {"F097","ğŸ™ "},
            {"F098","ğŸ™¡"},
            {"F099","ğŸ™£"},
            {"F09A","ğŸ™"},
            {"F09B","ğŸ™œ"},
            {"F09C","ğŸ™"},
            {"F09D","ğŸ™Ÿ"},
            {"F09E","Â·"},
            {"F09f","â€¢"},
            {"F0A0","â–ª"},
            {"F0A1","âšª"},
            {"F0A2","ğŸ†"},
            {"F0A3","ğŸˆ"},
            {"F0A4","â—‰"},
            {"F0A5","â—"},
            {"F0A6","ğŸ”¿"},
            {"F0A7","â–ª"},
            {"F0A8","â—»"},
            {"F0A9","ğŸŸ‚"},
            {"F0AA","âœ¦"},
            {"F0AB","â˜…"},
            {"F0AC","âœ¶"},
            {"F0AD","âœ´"},
            {"F0AE","âœ¹"},
            {"F0AF","âœµ"},
            {"F0B0","â¯"},
            {"F0B1","âŒ–"},
            {"F0B2","âŸ¡"},
            {"F0B3","âŒ‘"},
            {"F0B4","â¯‘"},
            {"F0B5","âœª"},
            {"F0B6","âœ°"},
            {"F0B7","ğŸ•"},
            {"F0B8","ğŸ•‘"},
            {"F0B9","ğŸ•’"},
            {"F0BA","ğŸ•“"},
            {"F0BB","ğŸ•”"},
            {"F0BC","ğŸ••"},
            {"F0BD","ğŸ•–"},
            {"F0BE","ğŸ•—"},
            {"F0BF","ğŸ•˜"},
            {"F0C0","ğŸ•™"},
            {"F0C1","ğŸ•š"},
            {"F0C2","ğŸ•›"},
            {"F0C3","â®°"},
            {"F0C4","â®±"},
            {"F0C5","â®²"},
            {"F0C6","â®³"},
            {"F0C7","â®´"},
            {"F0C8","â®µ"},
            {"F0C9","â®¶"},
            {"F0CA","â®·"},
            {"F0CB","ğŸ™ª"},
            {"F0CC","ğŸ™«"},
            {"F0CD","ğŸ™•"},
            {"F0CE","ğŸ™”"},
            {"F0CF","ğŸ™—"},
            {"F0D0","ğŸ™–"},
            {"F0D1","ğŸ™"},
            {"F0D2","ğŸ™‘"},
            {"F0D3","ğŸ™’"},
            {"F0D4","ğŸ™“"},
            {"F0D5","âŒ«"},
            {"F0D6","âŒ¦"},
            {"F0D7","â®˜"},
            {"F0D8","â®š"},
            {"F0D9","â®™"},
            {"F0DA","â®›"},
            {"F0DB","â®ˆ"},
            {"F0DC","â®Š"},
            {"F0DD","â®‰"},
            {"F0DE","â®‹"},
            {"F0DF","ğŸ¡¨"},
            {"F0E0","ğŸ¡ª"},
            {"F0E1","ğŸ¡©"},
            {"F0E2","ğŸ¡«"},
            {"F0E3","ğŸ¡¬"},
            {"F0E4","ğŸ¡­"},
            {"F0E5","ğŸ¡¯"},
            {"F0E6","ğŸ¡¯"},
            {"F0E7","ğŸ¡®"},
            {"F0E8","ğŸ¡¸"},
            {"F0E9","ğŸ¡º"},
            {"F0EA","ğŸ¡¹"},
            {"F0EB","ğŸ¡»"},
            {"F0EC","ğŸ¡¼"},
            {"F0ED","ğŸ¡½"},
            {"F0EE","ğŸ¡¿"},
            {"F0EF","ğŸ¡¾"},
            {"F0F0","â‡¦"},
            {"F0F1","â‡¨"},
            {"F0F2","â‡§"},
            {"F0F3","â‡©"},
            {"F0F4","â¬„"},
            {"F0F5","â‡³"},
            {"F0F6","â¬"},
            {"F0F7","â¬ƒ"},
            {"F0F8","â¬‚"},
            {"F0F9","ğŸ¢¬"},
            {"F0FA","ğŸ¢­"},
            {"F0FB","ğŸ—¶"},
            {"F0FC","âœ”"},
            {"F0FD","ğŸ—·"},
            {"F0FE","ğŸ—¹"},
    };

        /// <summary>
        /// Default ctor
        /// </summary>
        public SymbolHandler()
        {
            DefaultSymbolHandler = new OpenXmlPowerTools.OpenXMLWordprocessingMLToHtmlConverter.SymbolHandler();
        }

        /// <summary>
        /// Default handler that transforms every symbol into some html encoded font specific char
        /// </summary>
        /// <param name="element"></param>
        /// <param name="fontFamily"></param>
        /// <returns></returns>
        public XElement TransformSymbol(XElement element, Dictionary<string, string> fontFamily)
        {
            if (fontFamily.TryGetValue("font-family", out var currentSymbolFontFamily) && currentSymbolFontFamily == "Symbol")
            {
                var customChar = element.Attribute(W._char)?.Value;

                if (customChar != null && SymbolCharDictonary.TryGetValue(customChar, out var commonChar))
                {
                    return new XElement(Xhtml.span, commonChar);
                }
            }
            else if (fontFamily.TryGetValue("font-family", out var currentWingdingsFontFamily) && currentWingdingsFontFamily == "Wingdings")
            {
                var customChar = element.Attribute(W._char)?.Value;

                if (customChar != null && WingdingsCharDictonary.TryGetValue(customChar, out var commonChar))
                {
                    return new XElement(Xhtml.span, commonChar);
                }
            }

            return DefaultSymbolHandler.TransformSymbol(element, fontFamily);
        }
    }
}